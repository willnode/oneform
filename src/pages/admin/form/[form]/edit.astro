---
import Layout from "@/layouts/Layout.astro";
import { backToLogin, notFound } from "@/components/helper";
import EditForm from "./_edit.tsx";
import FormNavbar from "@/components/editor/FormNavbar.tsx";
import query from "@/lib/query.ts";
import { getTeam } from "@/lib/auth";

const { form: formId } = Astro.params;

if (!formId) {
  return notFound();
}

const teamId = await getTeam(Astro.request);
if (!teamId) {
  return backToLogin();
}

const form = await query.getFormById(formId);
if (!form || form.teamId != teamId) {
  return notFound();
}

---

<Layout title="Edit Form.">
  <FormNavbar page="edit" />
  <EditForm client:only="react" value={form} />
</Layout>
